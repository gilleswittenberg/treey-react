(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{29:function(e,t,n){e.exports=n(79)},63:function(e,t,n){},64:function(e,t,n){},69:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){},79:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(24),u=n.n(c),o=n(3),i=Object(a.createContext)({tree:null,treey:null}),l=n(2),s=n.n(l),m=n(4),f=n(6),p=n.n(f),d=p.a.treey,v=d.init,E=d.read,b=d.createAndAdd,h=d.update,g=d.remove,w=d.move,O=function(){var e=Object(a.useState)(),t=Object(o.a)(e,2),n=t[0],r=t[1];Object(a.useEffect)(function(){Object(m.a)(s.a.mark(function e(){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v();case 2:t=e.sent,r(t);case 4:case"end":return e.stop()}},e)}))()},[]);var c={read:function(){var e=Object(m.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),createAndAdd:function(){var e=Object(m.a)(s.a.mark(function e(t,n){var a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b(t,n);case 2:a=e.sent,r(a);case 4:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),update:function(){var e=Object(m.a)(s.a.mark(function e(t,n){var a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(t,n);case 2:a=e.sent,r(a);case 4:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),remove:function(){var e=Object(m.a)(s.a.mark(function e(t,n,a){var c;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(t,n,a);case 2:c=e.sent,r(c);case 4:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}(),move:function(){var e=Object(m.a)(s.a.mark(function e(t,n,a,c,u){var o;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w(t,n,a,c,u);case 2:o=e.sent,r(o);case 4:case"end":return e.stop()}},e)}));return function(t,n,a,r,c){return e.apply(this,arguments)}}()};return[n,c]},x=function(e){var t=e.children,n=O(),a=Object(o.a)(n,2),c={tree:a[0],treey:a[1]};return r.a.createElement(i.Provider,{value:c},t)},y=function(){throw new Error("UIContext not implemented")},j={isShownForm:y,setShownForm:y,unsetShownForm:y},k=Object(a.createContext)(j),N=function(e){Object(a.useEffect)(function(){var t=function(t){27===t.keyCode&&(t.preventDefault(),e())};return window.addEventListener("keydown",t),function(){return window.removeEventListener("keydown",t)}},[e])},S=p.a.utils.createFullName,D=function(e){var t=e.children,n=Object(a.useState)(),c=Object(o.a)(n,2),u=c[0],i=c[1],l=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.map(function(e){return S(e)});return(t?n.concat("add"):n).join("/")},s=function(){return i(void 0)};N(s),Object(a.useEffect)(function(){return window.addEventListener("click",s),function(){return window.removeEventListener("click",s)}},[]);var m={isShownForm:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return u===l(e,t)},setShownForm:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return i(l(e,t))},unsetShownForm:s};return r.a.createElement(k.Provider,{value:m},t)},C=n(8),F="gilleswittenberg.github.io"===window.location.host?"/treey-react/":"/",I=(n(63),function(){return r.a.createElement("header",{className:"Header"},r.a.createElement(C.a,{to:F},r.a.createElement("h1",null,r.a.createElement("img",{src:"/treey-react/images/logo_64x64.png",width:"32px",height:"32px",alt:"\u6728"})),r.a.createElement("h2",null,"treey")))}),A=(n(64),function(){return r.a.createElement("p",{className:"Spinner"},"is loading\u2026")}),P=n(10),B=(n(69),function(e){var t=e.type,n=e.onClick,a="Button "+t,c={backgroundImage:'url("'.concat("/treey-react","/images/").concat(function(e){switch(e){case"ADD":return"add_64x64.png";case"EDIT":return"submit_64x64.png";case"DELETE":return"remove_64x64.png"}}(t),'")')};return r.a.createElement("button",{className:a,style:c,onClick:n,title:t},t)}),H=function(e){var t=e.data,n=/^https?:\/\//.test(t);return r.a.createElement("span",{className:"ItemData"},n?r.a.createElement("a",{href:t,onClick:function(e){return e.stopPropagation()}},t):t)},J=p.a.utils.createFullName,L=function(e){return e.state.ids&&e.state.ids[0]},T=function(e,t){return e?t.concat(e):t},_=function(e){try{return JSON.parse(e)}catch(t){return e}},R=function(e){return e[e.length-1]},W=n(9),U=n.n(W),$=(n(70),function(e){var t=e.parents,n=e.index,c=e.item,u=e.isDragging,l=L(c),f=R(t),p=T(l,t),d=function(e){return e.state&&e.state.data}(c),v=function(e){return"string"===typeof e?e:JSON.stringify(e,void 0,1)}(d),E=c.relations.length>0,b=Object(a.useState)(d),h=Object(o.a)(b,2),g=h[0],w=h[1],O=Object(a.useState)(!1),x=Object(o.a)(O,2),y=x[0],j=x[1],N=Object(a.useContext)(i).treey,S=Object(a.useContext)(k),D=S.isShownForm,I=S.setShownForm,A=S.unsetShownForm,P=D(p),J=u||!P,W=!u&&P,$=!u&&(y&&E||D(p,!0)),q=!E,z="".concat(F,"item/").concat(c.name),K=function(){var e=Object(m.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=N){e.next=2;break}return e.abrupt("return");case 2:if(null!=l){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,N.remove(l,f,n);case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),M=function(){var e=Object(m.a)(s.a.mark(function e(t){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),null!=N){e.next=3;break}return e.abrupt("return");case 3:if(null!=l){e.next=5;break}return e.abrupt("return");case 5:return n=_(g),e.next=8,N.update(l,n);case 8:A();case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"Item",onClick:function(e){return e.stopPropagation()}},r.a.createElement("div",{className:U()("ItemBody",{isHidden:!J,showAddButton:q})},r.a.createElement("span",{onClick:function(){D(p,!0)&&A();var e=window.getSelection();e&&""!==e.toString()||E&&j(!y)}},r.a.createElement(H,{data:v}),r.a.createElement(C.a,{to:z,className:"info"},"\u24d8")),q&&r.a.createElement(B,{type:"ADD",onClick:function(){I(p,!0),j(!0)}}),r.a.createElement(B,{type:"EDIT",onClick:function(){return I(p)}}),r.a.createElement(B,{type:"DELETE",onClick:K})),r.a.createElement("form",{onSubmit:M,className:U()({isHidden:!W})},r.a.createElement("input",{type:"text",onChange:function(e){var t=e.target.value;w(t)},value:g,autoFocus:!0}),r.a.createElement(B,{type:"EDIT"})),r.a.createElement("div",{className:U()({isHidden:!$})},r.a.createElement(G,{parents:p,items:c.relations})))}),q=(n(71),function(e){var t=e.parents,n=e.index,c=e.item,u=L(c),l=function(e,t){return T(e,t).map(function(e){return J(e)}).join("/")}(u,t),f=Object(a.useContext)(i).treey,p=Object(a.useRef)(null),d=Object(a.useState)(),v=Object(o.a)(d,2),E=v[0],b=v[1],h=Object(P.c)({item:{type:"item",parents:t,index:n,id:u},collect:function(e){return{isDragging:e.isDragging()}}}),g=Object(o.a)(h,2),w=g[0].isDragging,O=g[1],x=Object(P.d)({accept:"item",canDrop:function(e,t){return t.getItem().name!==l},drop:function(){var e=Object(m.a)(s.a.mark(function e(a,r){var c,u,o,i,l,m;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.didDrop()){e.next=2;break}return e.abrupt("return");case 2:if(u=(c=a).id,o=R(c.parents),i=c.index,l=R(t),m=n+("bottom"===E?1:0)-(o===l&&i<n?1:0),o!==l||i!==m){e.next=10;break}return e.abrupt("return");case 10:if(null!=f){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,f.move(u,o,l,i,m);case 14:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),hover:function(e,t){var n=t.getClientOffset(),a=p&&p.current&&p.current.getBoundingClientRect();if(a&&n){var r=n.y-a.top;b(r<=25?"top":"bottom")}},collect:function(e){return{isOver:e.isOver({shallow:!0}),canDrop:e.canDrop()}}}),y=Object(o.a)(x,2),j=y[0],k=j.canDrop,N=j.isOver,S=y[1],D=N&&k,C=D&&"top"===E,F=D&&"bottom"===E;return r.a.createElement("div",{ref:p},r.a.createElement("div",{ref:S},C&&r.a.createElement("div",{className:"dnd-placeholder"}),r.a.createElement("div",{ref:O,className:U()({isHidden:w})},r.a.createElement($,{parents:t,index:n,item:c,isDragging:w})),F&&r.a.createElement("div",{className:"dnd-placeholder"})))}),z=(n(72),function(e){var t=e.parents,n=Object(a.useState)(""),c=Object(o.a)(n,2),u=c[0],l=c[1],f=Object(a.useContext)(i).treey,p=Object(a.useContext)(k),d=p.isShownForm,v=p.setShownForm,E=p.unsetShownForm,b=d(t,!0),h=!b,g=function(){var e=Object(m.a)(s.a.mark(function e(n){var a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),null!=f){e.next=3;break}return e.abrupt("return");case 3:if(void 0!==(a=R(t))){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,f.createAndAdd(u,a);case 8:E(),l("");case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"FormAdd",onClick:function(e){return e.stopPropagation()}},h&&r.a.createElement(B,{onClick:function(){return v(t,!0)},type:"ADD"}),b&&r.a.createElement("form",{onSubmit:g},r.a.createElement("input",{type:"text",onChange:function(e){var t=e.target.value;l(t)},value:u,autoFocus:!0}),r.a.createElement(B,{type:"ADD"})))}),G=(n(73),function(e){var t=e.parents,n=e.items,a=n.length>0;return r.a.createElement("div",{className:"Items"},a&&r.a.createElement("ul",null,n.map(function(e,n){return r.a.createElement("li",{key:e.name},r.a.createElement(q,{parents:t,index:n,item:e}))})),r.a.createElement(z,{parents:t}))}),K=n(28),M=(n(74),function(e){var t=e.tree,n=(e.treey,t&&t.relations),a=t&&t.state.ids&&t.state.ids[0],c=[a];return r.a.createElement("div",{className:"Tree"},a&&r.a.createElement(P.b,{backend:K.a},r.a.createElement(G,{parents:c,items:n})))}),Q=(n(75),function(){var e=Object(a.useContext)(i),t=e.tree,n=e.treey,c=null==t,u=null!=t&&null!=n,o=null!=t?t.name:"";return r.a.createElement("div",{className:"Page PageHome"},c&&r.a.createElement(A,null),u&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",{className:"RootItem"},o),r.a.createElement(M,{tree:t,treey:n})))}),V=(n(76),p.a.utils.parseFullName),X=function(e){var t=e.fullName,n=Object(a.useState)(),c=Object(o.a)(n,2),u=c[0],l=c[1],f=Object(a.useState)(!1),p=Object(o.a)(f,2),d=p[0],v=p[1],E=Object(a.useState)(!1),b=Object(o.a)(E,2),h=b[0],g=b[1],w=Object(a.useContext)(i).treey;Object(a.useEffect)(function(){if(null!=w){var e=V(t);null!=e?Object(m.a)(s.a.mark(function t(){var n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.read(e);case 2:void 0!==(n=t.sent)?l(n):v(!0);case 4:case"end":return t.stop()}},t)}))():g(!0)}},[w,t]);var O=!1===d&&!1===h&&null==u,x=null!=u,y=u&&u.name,j=u&&JSON.stringify(u.state);return r.a.createElement("div",{className:"ItemOverview"},O&&r.a.createElement("p",null,"is loading\u2026"),h&&r.a.createElement("p",null,t," is not valid"),d&&r.a.createElement("p",null,t," not found"),x&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,y),r.a.createElement("h2",null,"state"),r.a.createElement("p",{className:"small"},j),r.a.createElement("h2",null,"events"),r.a.createElement("ul",null,u&&u.events.map(function(e,t){var n=e.payload?JSON.stringify(e.payload):null,a=null!=n,c=String(e.datetime);return r.a.createElement("li",{key:t},r.a.createElement("strong",null,e.type),r.a.createElement("br",null),a&&r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"small"},n),r.a.createElement("br",null)),c)}))))},Y=function(e){var t=e.fullName;return r.a.createElement("div",{className:"Page PageItem"},r.a.createElement(X,{fullName:t||""}))},Z=(n(77),function(){return r.a.createElement("div",{className:"Page Page404"},r.a.createElement("p",null,"404"))}),ee=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(I,null),r.a.createElement("main",null,r.a.createElement(x,null,r.a.createElement(D,null,r.a.createElement(C.b,{basepath:F},r.a.createElement(Q,{path:"/"}),r.a.createElement(Y,{path:"/item/:fullName"}),r.a.createElement(Z,{default:!0}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(78);u.a.render(r.a.createElement(ee,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[29,1,2]]]);
//# sourceMappingURL=main.c9ec967d.chunk.js.map