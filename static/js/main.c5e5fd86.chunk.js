(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{18:function(e,t,n){e.exports=n(64)},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){},64:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(16),u=n.n(c),l=n(2),o=Object(a.createContext)({tree:null,treey:null}),i=n(1),s=n.n(i),m=n(3),f=n(6),p=n.n(f),v=p.a.treey,d=v.init,E=v.read,b=v.createAndAdd,w=v.update,h=v.remove,x=v.move,y=function(){var e=Object(a.useState)(),t=Object(l.a)(e,2),n=t[0],r=t[1];Object(a.useEffect)(function(){Object(m.a)(s.a.mark(function e(){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d();case 2:t=e.sent,r(t);case 4:case"end":return e.stop()}},e)}))()},[]);var c={read:function(){var e=Object(m.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),createAndAdd:function(){var e=Object(m.a)(s.a.mark(function e(t,n){var a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b(t,n);case 2:a=e.sent,r(a);case 4:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),update:function(){var e=Object(m.a)(s.a.mark(function e(t,n){var a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w(t,n);case 2:a=e.sent,r(a);case 4:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),remove:function(){var e=Object(m.a)(s.a.mark(function e(t,n,a){var c;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(t,n,a);case 2:c=e.sent,r(c);case 4:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}(),move:function(){var e=Object(m.a)(s.a.mark(function e(t,n,a,c,u){var l;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x(t,n,a,c,u);case 2:l=e.sent,r(l);case 4:case"end":return e.stop()}},e)}));return function(t,n,a,r,c){return e.apply(this,arguments)}}()};return[n,c]},O=function(e){var t=e.children,n=y(),a=Object(l.a)(n,2),c={tree:a[0],treey:a[1]};return r.a.createElement(o.Provider,{value:c},t)},j=Object(a.createContext)({shownForm:null,setShownForm:null}),g=function(e){Object(a.useEffect)(function(){var t=function(t){27===t.keyCode&&(t.preventDefault(),e())};return window.addEventListener("keydown",t),function(){return window.removeEventListener("keydown",t)}},[e])},k=function(e){var t=e.children,n=Object(a.useState)(),c=Object(l.a)(n,2),u=c[0],o=c[1],i=function(){return o(null)};g(i),Object(a.useEffect)(function(){return window.addEventListener("click",i),function(){return window.removeEventListener("click",i)}},[]);var s={shownForm:u,setShownForm:o};return r.a.createElement(j.Provider,{value:s},t)},N=n(4),C=(n(53),function(){return r.a.createElement("header",{className:"Header"},r.a.createElement(N.a,{to:"/"},r.a.createElement("h1",null,r.a.createElement("img",{src:"/treey-react/images/logo_64x64.png",width:"32px",height:"32px",alt:"\u6728"})),r.a.createElement("h2",null,"treey")))}),S=(n(54),function(){return r.a.createElement("p",{className:"spinner"},"is loading\u2026")}),F=(n(55),function(e){var t=e.type,n=e.onClick,a="Button "+t,c={backgroundImage:'url("'.concat("/treey-react","/images/").concat(function(e){switch(e){case"ADD":return"add_64x64.png";case"EDIT":return"submit_64x64.png";case"DELETE":return"remove_64x64.png"}}(t),'")')};return r.a.createElement("button",{className:a,style:c,onClick:n,title:t},t)}),D=function(e){return e[e.length-1]},A=(n(56),function(e){var t=e.parents,n=e.index,c=e.item,u=function(e){return e.state.ids&&e.state.ids[0]}(c),i=D(t),f=u?t.concat(u):void 0,p=f?f.map(function(e){return e.name}).join("/"):void 0,v=c.state&&c.state.data,d=Object(a.useState)(v),E=Object(l.a)(d,2),b=E[0],w=E[1],h=Object(a.useState)(!1),x=Object(l.a)(h,2),y=x[0],O=x[1],g=Object(a.useContext)(o).treey,k=Object(a.useContext)(j),C=k.shownForm,S=k.setShownForm,A=C===p,I=!A,L=A,T=u&&y,B="/item/".concat(c.name),J=function(){var e=Object(m.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=g){e.next=2;break}return e.abrupt("return");case 2:if(null!=u){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,g.remove(u,i,n);case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),_=function(){var e=Object(m.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),null!=g){e.next=3;break}return e.abrupt("return");case 3:if(null!=u){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,g.update(u,b);case 7:S(null);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"Item",onClick:function(e){return e.stopPropagation()}},I&&r.a.createElement("div",{className:"ItemBody"},r.a.createElement("span",{onClick:function(){return O(!y)}},v,r.a.createElement(N.a,{to:B,className:"info"},"\u24d8")),r.a.createElement(F,{type:"EDIT",onClick:function(){return S(p)}}),r.a.createElement(F,{type:"DELETE",onClick:J})),L&&r.a.createElement("form",{onSubmit:_},r.a.createElement("input",{type:"text",onChange:function(e){var t=e.target.value;w(t)},value:b,autoFocus:!0}),r.a.createElement(F,{type:"EDIT"})),u&&f&&T&&r.a.createElement(P,{parents:f,items:c.relations}))}),I=(n(57),function(e){var t=e.parents,n=D(t),c=t.map(function(e){return e.name}).join("/")+"/add",u=Object(a.useState)(""),i=Object(l.a)(u,2),f=i[0],p=i[1],v=Object(a.useContext)(o).treey,d=Object(a.useContext)(j),E=d.shownForm,b=d.setShownForm,w=E===c,h=!w,x=function(){var e=Object(m.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),null!=v){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,v.createAndAdd(f,n);case 5:b(null),p("");case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"FormAdd"},h&&r.a.createElement(F,{onClick:function(){return b(c)},type:"ADD"}),w&&r.a.createElement("form",{onSubmit:x},r.a.createElement("input",{type:"text",onChange:function(e){var t=e.target.value;p(t)},value:f,autoFocus:!0}),r.a.createElement(F,{type:"ADD"})))}),P=(n(58),function(e){var t=e.parents,n=e.items,a=n.length>0;return r.a.createElement("div",{className:"Items"},a&&r.a.createElement("ul",null,n.map(function(e,n){return r.a.createElement("li",{key:e.name},r.a.createElement(A,{parents:t,index:n,item:e}))})),r.a.createElement(I,{parents:t}))}),L=(n(59),function(e){var t=e.tree,n=(e.treey,t&&t.relations),a=t&&t.state.ids&&t.state.ids[0],c=[a];return r.a.createElement("div",{className:"Tree"},a&&r.a.createElement(P,{parents:c,items:n}))}),T=(n(60),function(){var e=Object(a.useContext)(o),t=e.tree,n=e.treey,c=null==t,u=null!=t&&null!=n,l=null!=t?t.name:"";return r.a.createElement("div",{className:"Page PageHome"},c&&r.a.createElement(S,null),u&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",{className:"RootItem"},l),r.a.createElement(L,{tree:t,treey:n})))}),B=(n(61),p.a.utils.parseFullName),J=function(e){var t=e.fullName,n=Object(a.useState)(),c=Object(l.a)(n,2),u=c[0],i=c[1],f=Object(a.useState)(!1),p=Object(l.a)(f,2),v=p[0],d=p[1],E=Object(a.useState)(!1),b=Object(l.a)(E,2),w=b[0],h=b[1],x=Object(a.useContext)(o).treey;Object(a.useEffect)(function(){if(null!=x){var e=B(t);null!=e?Object(m.a)(s.a.mark(function t(){var n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x.read(e);case 2:void 0!==(n=t.sent)?i(n):d(!0);case 4:case"end":return t.stop()}},t)}))():h(!0)}},[x,t]);var y=!1===v&&!1===w&&null==u,O=null!=u,j=u&&u.name,g=u&&JSON.stringify(u.state);return r.a.createElement("div",{className:"ItemOverview"},y&&r.a.createElement("p",null,"is loading\u2026"),w&&r.a.createElement("p",null,t," is not valid"),v&&r.a.createElement("p",null,t," not found"),O&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,j),r.a.createElement("h2",null,"state"),r.a.createElement("p",{className:"small"},g),r.a.createElement("h2",null,"events"),r.a.createElement("ul",null,u&&u.events.map(function(e,t){var n=e.payload?JSON.stringify(e.payload):null,a=null!=n,c=String(e.datetime);return r.a.createElement("li",{key:t},r.a.createElement("strong",null,e.type),r.a.createElement("br",null),a&&r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"small"},n),r.a.createElement("br",null)),c)}))))},_=function(e){var t=e.fullName;return r.a.createElement("div",{className:"Page PageItem"},r.a.createElement(J,{fullName:t||""}))},H=(n(62),function(){return r.a.createElement("div",{className:"Page Page404"},r.a.createElement("p",null,"404"))}),W=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(C,null),r.a.createElement("main",null,r.a.createElement(O,null,r.a.createElement(k,null,r.a.createElement(N.b,null,r.a.createElement(T,{path:"/"}),r.a.createElement(_,{path:"item/:fullName"}),r.a.createElement(H,{default:!0}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(63);u.a.render(r.a.createElement(W,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[18,1,2]]]);
//# sourceMappingURL=main.c5e5fd86.chunk.js.map