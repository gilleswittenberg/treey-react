(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{30:function(e,t,n){e.exports=n(81)},64:function(e,t,n){},65:function(e,t,n){},70:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){},79:function(e,t,n){},80:function(e,t,n){},81:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(24),u=n.n(c),i=n(3),o=Object(r.createContext)({tree:null,treey:null}),l=n(2),s=n.n(l),m=n(4),f=n(6),p=n.n(f),d=p.a.treey,v=d.init,E=d.read,b=d.createAndAdd,h=d.update,g=d.remove,w=d.move,x=function(){var e=Object(r.useState)(),t=Object(i.a)(e,2),n=t[0],a=t[1];Object(r.useEffect)(function(){Object(m.a)(s.a.mark(function e(){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v();case 2:t=e.sent,a(t);case 4:case"end":return e.stop()}},e)}))()},[]);var c={read:function(){var e=Object(m.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),createAndAdd:function(){var e=Object(m.a)(s.a.mark(function e(t,n){var r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b(t,n);case 2:r=e.sent,a(r);case 4:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),update:function(){var e=Object(m.a)(s.a.mark(function e(t,n){var r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(t,n);case 2:r=e.sent,a(r);case 4:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),remove:function(){var e=Object(m.a)(s.a.mark(function e(t,n,r){var c;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(t,n,r);case 2:c=e.sent,a(c);case 4:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}(),move:function(){var e=Object(m.a)(s.a.mark(function e(t,n,r,c,u){var i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w(t,n,r,c,u);case 2:i=e.sent,a(i);case 4:case"end":return e.stop()}},e)}));return function(t,n,r,a,c){return e.apply(this,arguments)}}()};return[n,c]},O=function(e){var t=e.children,n=x(),r=Object(i.a)(n,2),c={tree:r[0],treey:r[1]};return a.a.createElement(o.Provider,{value:c},t)},j=function(){throw new Error("UIContext not implemented")},y={isShownForm:j,setShownForm:j,unsetShownForm:j},k=Object(r.createContext)(y),N=function(e){Object(r.useEffect)(function(){var t=function(t){27===t.keyCode&&(t.preventDefault(),e())};return window.addEventListener("keydown",t),function(){return window.removeEventListener("keydown",t)}},[e])},S=p.a.utils.createFullName,D=function(e){var t=e.children,n=Object(r.useState)(),c=Object(i.a)(n,2),u=c[0],o=c[1],l=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.map(function(e){return S(e)});return(t?n.concat("add"):n).join("/")},s=function(){return o(void 0)};N(s),Object(r.useEffect)(function(){return window.addEventListener("click",s),function(){return window.removeEventListener("click",s)}},[]);var m={isShownForm:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return u===l(e,t)},setShownForm:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return o(l(e,t))},unsetShownForm:s};return a.a.createElement(k.Provider,{value:m},t)},C=n(8),F="gilleswittenberg.github.io"===window.location.host?"/treey-react/":"/",I=(n(64),function(){return a.a.createElement("header",{className:"Header"},a.a.createElement(C.a,{to:F},a.a.createElement("h1",null,a.a.createElement("img",{src:"/treey-react/images/logo_64x64.png",width:"32px",height:"32px",alt:"\u6728"})),a.a.createElement("h2",null,"treey")))}),A=(n(65),function(){return a.a.createElement("p",{className:"Spinner"},"is loading\u2026")}),P=n(11),B=(n(70),function(e){var t=e.type,n=e.onClick,r="Button "+t,c={backgroundImage:'url("'.concat("/treey-react","/images/").concat(function(e){switch(e){case"ADD":return"add_64x64.png";case"EDIT":return"submit_64x64.png";case"DELETE":return"remove_64x64.png"}}(t),'")')};return a.a.createElement("button",{className:r,style:c,onClick:n,title:t},t)}),H=function(e){var t=e.data,n=/^https?:\/\//.test(t);return a.a.createElement("span",{className:"ItemData"},n?a.a.createElement("a",{href:t,onClick:function(e){return e.stopPropagation()}},t):t)},J=p.a.utils.createFullName,L=function(e){return e.state.ids&&e.state.ids[0]},T=function(e,t){return e?t.concat(e):t},_=function(e){try{return JSON.parse(e)}catch(t){return e}},R=function(e){return e[e.length-1]},W=n(9),q=n.n(W),U=n(28),$=(n(72),function(e){var t=e.parents,n=e.index,c=e.item,u=e.isDragging,l=L(c),f=R(t),p=T(l,t),d=function(e){return e.state&&e.state.data}(c),v=function(e){return"string"===typeof e?e:JSON.stringify(e,void 0,1)}(d),E=c.relations.length>0,b=Object(r.useState)(v),h=Object(i.a)(b,2),g=h[0],w=h[1],x=Object(r.useState)(!1),O=Object(i.a)(x,2),j=O[0],y=O[1],N=Object(r.useContext)(o).treey,S=function(){var e=Object(m.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=N){e.next=2;break}return e.abrupt("return");case 2:if(null!=l){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,N.remove(l,f,n);case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),D=Object(r.useContext)(k),I=D.isShownForm,A=D.setShownForm,P=D.unsetShownForm,J=I(p),W=u||!J,$=!u&&J,z=!u&&(j&&E||I(p,!0)),G=!E,M="".concat(F,"item/").concat(c.name),Q=S,V=function(){var e=Object(m.a)(s.a.mark(function e(t){var n,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),P(),""!==(n=g.trim())){e.next=5;break}return e.abrupt("return",S());case 5:if(r=_(n),!Object(U.isEqual)(d,r)){e.next=8;break}return e.abrupt("return");case 8:if(null!=N){e.next=10;break}return e.abrupt("return");case 10:if(null!=l){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,N.update(l,r);case 14:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return a.a.createElement("div",{className:"Item",onClick:function(e){return e.stopPropagation()}},a.a.createElement("div",{className:q()("ItemBody",{isHidden:!W,showAddButton:G})},a.a.createElement("span",{onClick:function(){I(p,!0)&&P();var e=window.getSelection();e&&""!==e.toString()||E&&y(!j)}},a.a.createElement(H,{data:v}),a.a.createElement(C.a,{to:M,className:"info"},"\u24d8")),G&&a.a.createElement(B,{type:"ADD",onClick:function(){A(p,!0),y(!0)}}),a.a.createElement(B,{type:"EDIT",onClick:function(){return A(p)}}),a.a.createElement(B,{type:"DELETE",onClick:Q})),a.a.createElement("form",{onSubmit:V,className:q()({isHidden:!$})},a.a.createElement("input",{type:"text",value:g,onChange:function(e){var t=e.target.value;w(t)},ref:function(e){return e&&e.focus()}}),a.a.createElement(B,{type:"EDIT"})),a.a.createElement("div",{className:q()({isHidden:!z})},a.a.createElement(K,{parents:p,items:c.relations})))}),z=(n(73),function(e){var t=e.parents,n=e.index,c=e.item,u=L(c),l=function(e,t){return T(e,t).map(function(e){return J(e)}).join("/")}(u,t),f=Object(r.useContext)(o).treey,p=Object(r.useRef)(null),d=Object(r.useState)(),v=Object(i.a)(d,2),E=v[0],b=v[1],h=Object(P.c)({item:{type:"item",parents:t,index:n,id:u},collect:function(e){return{isDragging:e.isDragging()}}}),g=Object(i.a)(h,2),w=g[0].isDragging,x=g[1],O=Object(P.d)({accept:"item",canDrop:function(e,t){return t.getItem().name!==l},drop:function(){var e=Object(m.a)(s.a.mark(function e(r,a){var c,u,i,o,l,m;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.didDrop()){e.next=2;break}return e.abrupt("return");case 2:if(u=(c=r).id,i=R(c.parents),o=c.index,l=R(t),m=n+("bottom"===E?1:0)-(i===l&&o<n?1:0),i!==l||o!==m){e.next=10;break}return e.abrupt("return");case 10:if(null!=f){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,f.move(u,i,l,o,m);case 14:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),hover:function(e,t){var n=t.getClientOffset(),r=p&&p.current&&p.current.getBoundingClientRect();if(r&&n){var a=n.y-r.top;b(a<=25?"top":"bottom")}},collect:function(e){return{isOver:e.isOver({shallow:!0}),canDrop:e.canDrop()}}}),j=Object(i.a)(O,2),y=j[0],k=y.canDrop,N=y.isOver,S=j[1],D=N&&k,C=D&&"top"===E,F=D&&"bottom"===E;return a.a.createElement("div",{ref:p},a.a.createElement("div",{ref:S},C&&a.a.createElement("div",{className:"dnd-placeholder"}),a.a.createElement("div",{ref:x,className:q()({isHidden:w})},a.a.createElement($,{parents:t,index:n,item:c,isDragging:w})),F&&a.a.createElement("div",{className:"dnd-placeholder"})))}),G=(n(74),function(e){var t=e.parents,n=Object(r.useState)(""),c=Object(i.a)(n,2),u=c[0],l=c[1],f=Object(r.useContext)(o).treey,p=Object(r.useContext)(k),d=p.isShownForm,v=p.setShownForm,E=p.unsetShownForm,b=d(t,!0),h=!b,g=function(){var e=Object(m.a)(s.a.mark(function e(n){var r,a,c;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),""!==(r=u.trim())){e.next=5;break}return E(),e.abrupt("return");case 5:if(null!=f){e.next=7;break}return e.abrupt("return");case 7:if(void 0!==(a=R(t))){e.next=10;break}return e.abrupt("return");case 10:return c=_(r),e.next=13,f.createAndAdd(c,a);case 13:E(),l("");case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return a.a.createElement("div",{className:"FormAdd",onClick:function(e){return e.stopPropagation()}},h&&a.a.createElement(B,{onClick:function(){return v(t,!0)},type:"ADD"}),b&&a.a.createElement("form",{onSubmit:g},a.a.createElement("input",{type:"text",onChange:function(e){var t=e.target.value;l(t)},value:u,autoFocus:!0}),a.a.createElement(B,{type:"ADD"})))}),K=(n(75),function(e){var t=e.parents,n=e.items,r=n.length>0;return a.a.createElement("div",{className:"Items"},r&&a.a.createElement("ul",null,n.map(function(e,n){return a.a.createElement("li",{key:e.name},a.a.createElement(z,{parents:t,index:n,item:e}))})),a.a.createElement(G,{parents:t}))}),M=n(29),Q=(n(76),function(e){var t=e.tree,n=(e.treey,t&&t.relations),r=t&&t.state.ids&&t.state.ids[0],c=[r];return a.a.createElement("div",{className:"Tree"},r&&a.a.createElement(P.b,{backend:M.a},a.a.createElement(K,{parents:c,items:n})))}),V=(n(77),function(){var e=Object(r.useContext)(o),t=e.tree,n=e.treey,c=null==t,u=null!=t&&null!=n,i=null!=t?t.name:"";return a.a.createElement("div",{className:"Page PageHome"},c&&a.a.createElement(A,null),u&&a.a.createElement(a.a.Fragment,null,a.a.createElement("h1",{className:"RootItem"},i),a.a.createElement(Q,{tree:t,treey:n})))}),X=(n(78),p.a.utils.parseFullName),Y=function(e){var t=e.fullName,n=Object(r.useState)(),c=Object(i.a)(n,2),u=c[0],l=c[1],f=Object(r.useState)(!1),p=Object(i.a)(f,2),d=p[0],v=p[1],E=Object(r.useState)(!1),b=Object(i.a)(E,2),h=b[0],g=b[1],w=Object(r.useContext)(o).treey;Object(r.useEffect)(function(){if(null!=w){var e=X(t);null!=e?Object(m.a)(s.a.mark(function t(){var n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.read(e);case 2:void 0!==(n=t.sent)?l(n):v(!0);case 4:case"end":return t.stop()}},t)}))():g(!0)}},[w,t]);var x=!1===d&&!1===h&&null==u,O=null!=u,j=u&&u.name,y=u&&JSON.stringify(u.state,void 0,2);return a.a.createElement("div",{className:"ItemOverview"},x&&a.a.createElement("p",null,"is loading\u2026"),h&&a.a.createElement("p",null,t," is not valid"),d&&a.a.createElement("p",null,t," not found"),O&&a.a.createElement(a.a.Fragment,null,a.a.createElement("h1",null,j),a.a.createElement("h2",null,"state"),a.a.createElement("p",{className:"small pre"},y),a.a.createElement("h2",null,"events"),a.a.createElement("ul",null,u&&u.events.map(function(e,t){var n=e.payload?JSON.stringify(e.payload,void 0,1):null,r=null!=n,c=String(e.datetime);return a.a.createElement("li",{key:t},a.a.createElement("strong",null,e.type),a.a.createElement("br",null),r&&a.a.createElement(a.a.Fragment,null,a.a.createElement("span",{className:"small"},n),a.a.createElement("br",null)),c)}))))},Z=function(e){var t=e.fullName;return a.a.createElement("div",{className:"Page PageItem"},a.a.createElement(Y,{fullName:t||""}))},ee=(n(79),function(){return a.a.createElement("div",{className:"Page Page404"},a.a.createElement("p",null,"404"))}),te=function(){return a.a.createElement("div",{className:"App"},a.a.createElement(I,null),a.a.createElement("main",null,a.a.createElement(O,null,a.a.createElement(D,null,a.a.createElement(C.b,{basepath:F},a.a.createElement(V,{path:"/"}),a.a.createElement(Z,{path:"/item/:fullName"}),a.a.createElement(ee,{default:!0}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(80);u.a.render(a.a.createElement(te,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[30,1,2]]]);
//# sourceMappingURL=main.c6b83c37.chunk.js.map